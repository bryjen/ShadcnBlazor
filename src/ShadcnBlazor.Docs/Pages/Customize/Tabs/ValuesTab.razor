@using ShadcnBlazor.Docs.Models.Theme
<div class="h-full overflow-y-auto overflow-hidden scrollbar-hide flex flex-col gap-8">
    <div id="presets">
        <label class="text-xs text-muted-foreground">Theme Preset</label>
        <Select T="ThemePreset"
                Value="@_selectedThemePreset"
                ValueChanged="OnThemePresetChanged"
                Label="Theme Preset"
                Items="@(GetThemeOptions())"
                RenderItem="@RenderThemePresetItem"
                Placeholder="Select a theme"
                Disabled="@_loadingPresets">
        </Select>
        
        <div class="mt-2 text-xs text-muted-foreground">
            For more themes, see <a class="underline font-semibold text-foreground" href="https://tweakcn.com/community" target="_blank">tweakcn.com/community</a>.
            To copy a theme, select a theme, click <code>Code</code>, copy the CSS, and then paste it in the css editor in the other tab.
        </div>
    </div>
    
    <div id="colors">
        <h2 class="font-bold text-2xl text-foreground mb-4">
            Colors
        </h2>

        @for (var sectionIndex = 0; sectionIndex < Sections.Count; sectionIndex++)
        {
            var sectionIdx = sectionIndex;
            var group = Sections[sectionIdx];

            <section class="pb-6" @key="group.Title">
                <h3 class="text-sm font-semibold text-card-foreground">@group.Title</h3>
                <div class="grid grid-cols-2 gap-2">
                    @for (var fieldIndex = 0; fieldIndex < group.Fields.Count; fieldIndex++)
                    {
                        var fieldIdx = fieldIndex;
                        var field = group.Fields[fieldIdx];
                        var isValid = IsValidCssColor(field.Value);

                        <div class="space-y-1" @key="field.CssVarName">
                            <label class="text-[11px] font-medium text-muted-foreground">
                                @field.Label
                            </label>
                            <div class="grid grid-cols-[1.75rem_1fr] gap-2 items-center">
                                <div class="h-7 w-7 rounded-md border border-border" style="@GetSwatchStyle(field.Value, isValid)"></div>
                                <Input Value="@field.Value"
                                       Class="text-[0.775rem] text-foreground/75"
                                       OnChange="@(async e => await UpdateFieldValueAsync(field.CssVarName, e.Value?.ToString() ?? string.Empty))"/>
                            </div>
                        </div>
                    }
                </div>
            </section>
        }
    </div>
    
    <div id="typography">
        <h2 class="font-bold text-2xl text-foreground mb-4">
            Typography
        </h2>

        @for (var sectionIndex = 0; sectionIndex < Sections.Count; sectionIndex++)
        {
            var sectionIdx = sectionIndex;
            var group = Sections[sectionIdx];

            <section class="pb-7" @key="group.Title">
                <h3 class="text-sm font-semibold text-card-foreground">@group.Title</h3>
                <div class="grid grid-cols-2 gap-3">
                    @for (var fieldIndex = 0; fieldIndex < group.Fields.Count; fieldIndex++)
                    {
                        var fieldIdx = fieldIndex;
                        var field = group.Fields[fieldIdx];
                        var isValid = IsValidCssColor(field.Value);

                        <div class="space-y-1" @key="field.CssVarName">
                            <label class="text-[11px] font-medium text-muted-foreground">
                                @field.Label
                            </label>
                            <div class="grid grid-cols-[1.75rem_1fr] gap-2 items-center">
                                <div class="h-7 w-7 rounded-md border border-border" style="@GetSwatchStyle(field.Value, isValid)"></div>
                                <Input Value="@field.Value"
                                       Class="text-[0.775rem] text-foreground/75"
                                       OnChange="@(async e => await UpdateFieldValueAsync(field.CssVarName, e.Value?.ToString() ?? string.Empty))"/>
                            </div>
                        </div>
                    }
                </div>
            </section>
        }
    </div>
</div>

@code {
    private RenderFragment<SelectOption<ThemePreset>> RenderThemePresetItem => item => __builder =>
    {
        <div class="flex items-center gap-3 py-1">
            <div class="flex items-center gap-1">
                @foreach (var swatch in item.Value.Swatches)
                {
                    <span class="inline-block size-3 rounded-sm" style="background-color:@swatch"></span>
                }
            </div>
            <span class="font-medium">@item.DisplayText</span>
        </div>
    };
}