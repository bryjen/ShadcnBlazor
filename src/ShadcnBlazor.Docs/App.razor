@inject ThemeService ThemeService
@using ShadcnBlazor.Docs.Services.Theme
@implements IDisposable

<style id="shadcn-runtime-theme">@ThemeService.RuntimeStyleSheet</style>

<PopoverProvider RepositionDebounceMilliseconds="1" />
<DialogProvider />
<SheetProvider />
<Router AppAssembly="@typeof(App).Assembly">
    <Found Context="routeData">
        <RouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)"/>
        <FocusOnNavigate RouteData="@routeData" Selector="h1"/>
    </Found>
    <NotFound>
        <PageTitle>Not found</PageTitle>
        <NotFound />
    </NotFound>
</Router>

@code {
    protected override void OnInitialized()
    {
        ThemeService.ThemeChanged += OnThemeChanged;
    }

    private void OnThemeChanged()
    {
        _ = InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        ThemeService.ThemeChanged -= OnThemeChanged;
    }
}
