@using EasyAppDev.Blazor.Icons.Lucide

@inherits ShadcnComponentBase

<div class="w-full min-w-0 rounded-lg border border-border overflow-hidden">
    <div class="@(MergeCss("relative p-12 flex justify-center items-center min-w-0", Class))">
        <div class="flex justify-center items-center w-full max-w-full min-w-0 overflow-x-hidden">
            @ChildContent
        </div>
        
        @if (HasCode)
        {
            <Button Size="@Size.Md"
                    Variant="@Variant.Ghost"
                    Class="absolute top-2 right-2 text-xs text-muted-foreground hover:text-foreground"
                    OnClick="ToggleShowCode">
                @if (_showCode)
                {
                    <LuChevronUp class="size-3.5" />
                    @("Hide code")
                }
                else
                {
                    <LuCode class="size-3.5" />
                    @("Show code")
                }
            </Button>
        }
    </div>

    @if (HasCode)
    {
        <div class="docs-codeblock-accordion @(_showCode ? "docs-codeblock-accordion-expanded" : "") overflow-hidden @(_showCode ? "border-t border-border" : "") relative">
            <div class="docs-codeblock-accordion-inner min-w-0">
                <CodeBlock Code="@Code" Language="@Language" Style="@CodeBlockStyle.Embedded" />
            </div>
        </div>
    }
</div>

@code {
    private bool _showCode;
    private bool HasCode => !string.IsNullOrWhiteSpace(Code);

    private void ToggleShowCode()
    {
        _showCode = !_showCode;
    }
}
